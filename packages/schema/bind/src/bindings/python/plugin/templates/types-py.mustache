# NOTE: This is an auto-generated file. All modifications will be overwritten.
from __future__ import annotations

from typing import TypedDict, Optional
from enum import IntEnum, auto

from polywrap_core import InvokerClient, Uri, UriPackageOrWrapper
from polywrap_msgpack import GenericMap


### Env START ###

{{#envType}}
{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}} = TypedDict("{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}", {
    {{#properties}}
    "{{name}}": {{#toPython}}{{toGraphQLType}}{{/toPython}},
    {{/properties}}
})

{{/envType}}
### Env END ###

### Objects START ###

{{#objectTypes}}
{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}} = TypedDict("{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}", {
    {{#properties}}
    "{{name}}": {{#toPython}}{{toGraphQLType}}{{/toPython}},
    {{/properties}}
})

{{/objectTypes}}
### Objects END ###

### Enums START ###
{{#enumTypes}}
class {{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}(IntEnum):
    {{#constants}}
    {{#detectKeyword}}{{.}}{{/detectKeyword}} = auto() - 1, "{{.}}"
    {{/constants}}

    def __new__(cls, value: int, *aliases: str):
        obj = int.__new__(cls)
        obj._value_ = value
        for alias in aliases:
            cls._value2member_map_[alias] = obj
        return obj

{{/enumTypes}}
### Enums END ###

### Imported Objects START ###

{{#importedObjectTypes}}
# URI: "{{uri}}" #
{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}} = TypedDict("{{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}", {
    {{#properties}}
    "{{name}}": {{#toPython}}{{toGraphQLType}}{{/toPython}},
    {{/properties}}
})

{{/importedObjectTypes}}
### Imported Objects END ###

### Imported Enums START ###

{{#importedEnumTypes}}
# URI: "{{uri}}" #
class {{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}(IntEnum):
    {{#constants}}
    {{#detectKeyword}}{{.}}{{/detectKeyword}} = auto() - 1
    {{/constants}}

    def __new__(cls, value: int, *aliases: str):
        obj = int.__new__(cls)
        obj._value_ = value
        for alias in aliases:
            cls._value2member_map_[alias] = obj
        return obj

{{/importedEnumTypes}}

### Imported Enums END ###

### Imported Modules START ###

{{#importedModuleTypes}}
{{#methods}}
# URI: "{{parent.uri}}" #
{{#toUpper}}{{parent.type}}{{/toUpper}}Args{{#toUpper}}{{name}}{{/toUpper}} = TypedDict("{{#toUpper}}{{parent.type}}{{/toUpper}}Args{{#toUpper}}{{name}}{{/toUpper}}", {
    {{#arguments}}
    "{{name}}": {{#toPython}}{{toGraphQLType}}{{/toPython}},
    {{/arguments}}
})

{{/methods}}
# URI: "{{uri}}" #
{{^isInterface}}
class {{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}:
    {{#methods}}
    @staticmethod
    async def {{#detectKeyword}}{{#toLower}}{{name}}{{/toLower}}{{/detectKeyword}}(
        args: {{#toUpper}}{{parent.type}}{{/toUpper}}Args{{#toUpper}}{{name}}{{/toUpper}},
        client: InvokerClient[UriPackageOrWrapper]
    ) -> {{#return}}{{#toPython}}{{toGraphQLType}}{{/toPython}}{{/return}}:
        return client.invoke(
            InvokeOptions(
                uri=Uri.from_str("{{parent.uri}}"),
                method="{{name}}",
                args=args,
            )
        )
    {{^last}}

    {{/last}}
    {{/methods}}


{{/isInterface}}
{{#isInterface}}
class {{#detectKeyword}}{{#toUpper}}{{type}}{{/toUpper}}{{/detectKeyword}}:
    INTERFACE_URI: Uri = Uri.from_str("{{uri}}")
    uri: Uri

    def __init__(self, uri: Uri):
        self.uri = uri

    {{#methods}}
    async def {{#detectKeyword}}{{#toLower}}{{name}}{{/toLower}}{{/detectKeyword}}(
        self,
        args: {{#toUpper}}{{parent.type}}{{/toUpper}}Args{{#toUpper}}{{name}}{{/toUpper}},
        client: InvokerClient[UriPackageOrWrapper]
    ) -> {{#return}}{{#toPython}}{{toGraphQLType}}{{/toPython}}{{/return}}:
        return client.invoke(
            InvokeOptions(
                uri=self.uri,
                method="{{name}}",
                args=args,
            )
        )
    {{^last}}

    {{/last}}
    {{/methods}}

{{/isInterface}}
{{/importedModuleTypes}}
### Imported Modules END ###

### Interface START ###

{{#interfaceTypes.length}}
{{#interfaceTypes}}

class {{#detectKeyword}}{{#toUpper}}{{namespace}}{{/toUpper}}{{/detectKeyword}}:
    URI: Uri = Uri.from_str("{{uri}}")

    {{#capabilities}}
    {{#getImplementations}}
    {{#enabled}}
    def get_implementations(
        client: InvokerClient[UriPackageOrWrapper]
    ) -> list[str]:
        impls = client.getImplementations(self.uri)
        return [impl.uri for impl in impls]
    {{/enabled}}
    {{/getImplementations}}
    {{/capabilities}}
{{/interfaceTypes}}
{{/interfaceTypes.length}}

### Interface END ###
